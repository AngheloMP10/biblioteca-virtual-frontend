<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Cat√°logo de Libros</h2>
    <a routerLink="/libros/nuevo" class="btn btn-primary"> + Nuevo Libro </a>
  </div>

  <div class="card shadow-sm">
    <div class="card-body p-0">
      <table class="table table-striped table-hover mb-0 align-middle">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>Portada</th>
            <th>T√≠tulo</th>
            <th>A√±o</th>
            <th>Autores</th>
            <th>G√©nero</th>
            <th>Estado</th>
            <th class="text-end">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let libro of libros">
            <td>{{ libro.id }}</td>

            <td>
              <img
                *ngIf="libro.portada"
                [src]="libro.portada"
                alt="Portada"
                class="img-thumbnail"
                style="width: 45px; height: 65px; object-fit: cover"
              />
              <span *ngIf="!libro.portada" style="font-size: 1.5rem">üìò</span>
            </td>

            <td class="fw-bold">{{ libro.titulo }}</td>

            <td>{{ libro.anioPublicacion }}</td>

            <td>
              <span *ngFor="let autor of libro.autores; let isLast = last">
                {{ autor.nombre }}<span *ngIf="!isLast">, </span>
              </span>
              <span
                *ngIf="!libro.autores || libro.autores.length === 0"
                class="text-muted small"
              >
                Sin autores
              </span>
            </td>

            <td>
              <span class="badge bg-info text-dark">
                {{ libro.genero?.nombre || 'General' }}
              </span>
            </td>

            <td>
              <span
                class="badge"
                [ngClass]="libro.disponible ? 'bg-success' : 'bg-danger'"
              >
                {{ libro.disponible ? 'Disponible' : 'Agotado' }}
              </span>
            </td>

            <td class="text-end">
              <a
                [routerLink]="['/libros/editar', libro.id]"
                class="btn btn-warning btn-sm me-2"
              >
                ‚úèÔ∏è Editar
              </a>
              <button
                class="btn btn-danger btn-sm"
                (click)="eliminarLibro(libro.id)"
              >
                üóëÔ∏è Eliminar
              </button>
            </td>
          </tr>

          <tr *ngIf="libros.length === 0">
            <td colspan="8" class="text-center py-4">
              No hay libros registrados.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
